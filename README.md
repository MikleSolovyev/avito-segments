# AVITO segments service

Микросервис для работы с эксперементальными сегментами, в которых находятся пользователи

Используемые технологии:
- PostgreSQL (в качестве хранилища данных)
- Docker (для запуска сервиса)
- Swagger (для документации API)
- Echo (веб фреймворк)
- golang-migrate/migrate (для миграций БД)
- pgx (драйвер для работы с PostgreSQL)
- squirell (для составления SQL запросов)
- zerolog (логгер)
- go-playground/validator (валидатор)

Сервис был написан с использованием чистой архитектуры, что позволяет легко расширять функционал сервиса и тестировать его.
Также был реализован Graceful Shutdown для корректного завершения работы сервиса.


# Getting Started

- Заполнить .env файл (аргументы приведены в `.env.example`)
- Опционально, настроить `config/local.yml` под себя


# Usage

Запустить сервис можно с помощью команды `make compose-up`

Документацию после запуска сервиса можно посмотреть по адресу `http://localhost:8080/swagger/index.html`
с портом 8080 по умолчанию

Переинициализировать файлы документации можно при помощи команды `make swagger`


# Decisions

В ходе разработки возникли спорные моменты и были принятые следующие решения:

1. Насколько затратно хранить файлы с отчетами?
> Было принято решение отдавать файл с отчетом в ответе на запрос в целях экономии дискового пространства
2. Что происходят с пользователями, если сегмент в котором они находятся, удалили?
> При удалении сегмента у всех пользователей он пропадает из активных, даже при не истекшем ttl, то есть пользователи автоматом перестанут принадлежать ему при его удалении